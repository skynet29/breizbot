$$.control.registerControl("rootPage",{template:'<div class="toolbar">\n    <button bn-event="click: onRun" class="w3-btn w3-blue">Block</button>\n    <button bn-event="click: onGenerate" class="w3-btn w3-blue">Run</button>\n\n</div>\n<div id="blocklyDiv"></div>\n<div class="logPanel" bn-html="getLogs"></div>\n\n<xml id="toolbox" style="display: none;">\n    <category name="Logic" categorystyle="logic_category">\n        <block type="controls_if"></block>\n        <block type="logic_compare"></block>\n        <block type="logic_operation"></block>\n        <block type="logic_negate"></block>\n        <block type="logic_boolean"></block>\n        <block type="logic_ternary"></block>\n    </category>\n    <category name="Loop" categorystyle="loop_category">\n        <block type="controls_repeat_ext">\n            <value name="TIMES">\n                <shadow type="math_number">\n                    <field name="NUM">10</field>\n                </shadow>\n            </value>\n        </block>\n        <block type="controls_whileUntil"></block>\n        <block type="controls_for">\n            <value name="START">\n                <shadow type="math_number">\n                    <field name="NUM">1</field>\n                </shadow>\n            </value>\n            <value name="END">\n                <shadow type="math_number">\n                    <field name="NUM">10</field>\n                </shadow>\n            </value>\n            <value name="STEP">\n                <shadow type="math_number">\n                    <field name="NUM">1</field>\n                </shadow>\n            </value>\n        </block>\n        <block type="controls_forEach"></block>\n        <block type="controls_flow_statements"></block>\n    </category>\n    <category name="Math" categorystyle="math_category">\n        <block type="math_number"></block>\n        <block type="math_arithmetic"></block>\n        <block type="math_random_int">\n            <value name="FROM">\n                <shadow type="math_number">\n                    <field name="NUM">1</field>\n                </shadow>\n            </value>\n            <value name="TO">\n                <shadow type="math_number">\n                    <field name="NUM">100</field>\n                </shadow>\n            </value>\n        </block>\n    </category>\n    <category name="Text" categorystyle="text_category">\n        <block type="text"></block>\n        <block type="text_print"></block>\n        <block type="text_length">\n            <value name="VALUE">\n                <shadow type="text">\n                    <field name="TEXT">abc</field>\n                </shadow>\n            </value>\n        </block>\n        <block type="text_changeCase">\n            <field name="CASE">UPPERCASE</field>\n            <value name="TEXT">\n                <shadow type="text">\n                    <field name="TEXT">abc</field>\n                </shadow>\n            </value>\n        </block>\n        <block type="text_join">\n            <mutation items="2" />\n        </block>\n        <block type="text_indexOf"></block>\n        <block type="text_charAt"></block>\n        <block type="text_getSubstring"></block>\n        <block type="text_prompt_ext">\n            <mutation type="TEXT" />\n            <field name="TYPE">TEXT</field>\n            <value name="TEXT">\n                <shadow type="text">\n                    <field name="TEXT">abc</field>\n                </shadow>\n            </value>\n        </block>\n    </category>\n    <category name="Lists" categorystyle="list_category">\n        <block type="lists_create_with">\n            <mutation items="0"></mutation>\n        </block>\n        <block type="lists_create_with"></block>\n        <block type="lists_repeat">\n            <value name="NUM">\n                <shadow type="math_number">\n                    <field name="NUM">5</field>\n                </shadow>\n            </value>\n        </block>\n        <block type="lists_length"></block>\n        <block type="lists_isEmpty"></block>\n        <block type="lists_indexOf">\n            <value name="VALUE">\n                <block type="lexical_variable_get">\n                    <field name="VAR">list</field>\n                </block>\n            </value>\n        </block>\n        <block type="lists_getIndex">\n            <value name="VALUE">\n                <block type="lexical_variable_get">\n                    <field name="VAR">list</field>\n                </block>\n            </value>\n        </block>\n        <block type="lists_setIndex">\n            <value name="LIST">\n                <block type="lexical_variable_get">\n                    <field name="VAR">list</field>\n                </block>\n            </value>\n        </block>\n        <block type="lists_getSublist">\n            <value name="LIST">\n                <block type="lexical_variable_get">\n                    <field name="VAR">list</field>\n                </block>\n            </value>\n        </block>\n        <block type="lists_split">\n            <value name="DELIM">\n                <shadow type="text">\n                    <field name="TEXT">,</field>\n                </shadow>\n            </value>\n        </block>\n        <block type="lists_sort"></block>\n        <block type="lists_reverse"></block>\n    </category>\n    <category id="catVariables" colour="330" name="Variables">\n        <block type="global_declaration"></block>\n        <block type="local_declaration_statement"></block>\n        <block type="lexical_variable_get"></block>\n        <block type="lexical_variable_set"></block>\n    </category>\n    <category name="Functions" custom="PROCEDURE" categorystyle="procedure_category"></category>\n    <category name="Music" colour="355">\n        <block type="play_sound"></block>\n    </category>\n\n</xml>',deps:["breizbot.pager","breizbot.blocklyinterpretorLexical","breizbot.blockly"],props:{},init:function(e,n,l,t){Blockly.Blocks.play_sound={init:function(){this.appendDummyInput().appendField("Play").appendField(new Blockly.FieldDropdown([["C4","sounds/c4.m4a"],["D4","sounds/d4.m4a"],["E4","sounds/e4.m4a"]]),"NAME"),this.setPreviousStatement(!0,null),this.setNextStatement(!0,null),this.setColour(355),this.setTooltip(""),this.setHelpUrl("")}},javascript.javascriptGenerator.forBlock.play_sound=function(e,n){var l=e.getFieldValue("NAME");console.log("value",l);return"...\n"},t.inject("blocklyDiv",document.getElementById("toolbox")),l.setLogFunction(e=>{o.model.logs.push(e),o.update()});const o=$$.viewController(e,{data:{logs:[],getLogs:function(){return this.logs.join("<br>")}},events:{onRun:function(){const e=Blockly.serialization.workspaces.save(Blockly.getMainWorkspace());console.log("code",e)},onGenerate:function(){const e=Blockly.serialization.workspaces.save(Blockly.getMainWorkspace());o.setData({logs:[]}),l.startCode(e)}}})}});