$$.control.registerControl("rootPage",{template:'<div bn-control="breizbot.searchbar" \n\tbn-event="searchbarsubmit: onSearch"\n\tdata-placeholder="What are you looking for ?" \n\t></div>\n<div class="toolbar" bn-event="click.menuItem: onItemMenuClick">\n\t<span class="menuItem selected" data-theme="web"><i class="fa fa-globe"></i>Web</span>\n\t<span class="menuItem" data-theme="images"><i class="fa fa-image"></i>Images</span>\n</div>\t\n<div bn-if="isWeb" class="test">\n\t<div class="webResults w3-light-grey" >\n\t\t<div bn-each="results" bn-event="contextmenuchange.item: onContextMenu" bn-lazzy="20">\n\t\t\t<div class="w3-card-2 item" \n\t\t\t\tbn-control="brainjs.contextmenu" \n\t\t\t\tbn-data="{\n\t\t\t\t\titems: {\n\t\t\t\t\t\tadd: {name: \'Add to favorites\', icon: \'fas fa-star\'}\n\t\t\t\t\t}\n\t\t\t\t}">\n\t\t\t\t<div class="link">\n\t\t\t\t\t<a bn-attr="{href: $scope.$i.url}" bn-html="$scope.$i.title" class="link" target="_blank"></a>\n\t\t\t\t\t\n\t\t\t\t</div>\n\t\t\t\t<div bn-html="$scope.$i.source" class="source"></div>\t\t\n\t\t\t\t<div bn-html="$scope.$i.desc" class="desc"></div>\t\n\t\t\t</div>\n\t\t</div>\n\t\n\t</div>\n\t\n</div>\n\n<div bn-if="isImages" class="test" bn-event="click.item: onImageClick">\n\t<div class="imagesResults" >\n\t\t<div bn-each="results" bn-lazzy="20" class="items">\n\t\t\t<div bn-style="{width: $scope.$i.thumb_width, height: $scope.$i.thumb_height}" class="item w3-card-2">\n\t\t\t\t<img bn-attr="{src: getUrl}" style="display: none;">\n\t\t\t</div>\n\t\t</div>\n\t\n\t</div>\n\t\n</div>\n',deps:["breizbot.http","breizbot.pager","breizbot.files"],init:function(t,e,n,s){const i=$$.ui.progressDialog(),a=$$.viewController(t,{data:{results:[],theme:"web",query:"",isWeb:function(){return"web"==this.theme},isImages:function(){return"images"==this.theme},getUrl:function(t){return`https:${t.$i.thumbnail}`}},events:{onItemMenuClick:function(){const t=$(this),e=t.data("theme");console.log("onItemMenuClick",e),t.closest(".toolbar").find(".menuItem.selected").removeClass("selected"),t.addClass("selected"),e!=a.model.theme&&(a.setData({theme:e}),o())},onContextMenu:async function(t,n){const s=$(this).index(),{title:i,url:o}=a.model.results[s],l=await $$.ui.showPrompt({title:"Add link",label:"Name",value:i.replace(/<\/?b>/g,"")});console.log("name",l),null!=l&&await e.post("/addFavorite",{name:l,link:o})},onSearch:function(t,e){a.setData({query:e.value}),o()},onImageClick:function(){const t=$(this).index(),e=a.model.results[t],o=e.media;n.pushPage("breizbot.viewer",{title:e.title,props:{type:"image",url:o},buttons:{save:{title:"Save",icon:"fa fa-save",onClick:function(){!async function(t){const e="SNAP"+Date.now()+".png";console.log("fileName",e);try{i.setPercentage(0),i.show();const n=await $$.util.imageUrlToBlob(t);await s.uploadFile(n,e,"/apps/browser",t=>{i.setPercentage(t)});await $$.util.wait(1e3),i.hide()}catch(t){i.hide(),$$.ui.showAlert({title:"Error",content:t})}}(o)}}}})}}});async function o(){a.setData({results:[]});const{theme:t,query:n}=a.model;if(""!=n)try{const s=await e.post("/search",{query:n,theme:t});console.log("results",s),a.setData({results:s})}catch(t){$$.ui.showAlert({title:"Error",content:t.responseText})}}document.body.addEventListener("load",function(t){var e=t.target;"IMG"==e.tagName&&(e.style.display="inline")},!0)}});