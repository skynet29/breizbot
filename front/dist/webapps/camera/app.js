$$.control.registerControl("rootPage",{deps:["breizbot.files"],template:'<div class="main">\n\t<div bn-control="brainjs.camera" bn-iface="camera" bn-data="{constraints}"></div>\t\n\n\t<button title="Take picture" \n\tbn-event="click: onTakePicture" class="w3-btn w3-blue"><i class="fa fa-camera"></i></button>\t\n</div>\n',props:{$pager:null},init:function(t,e){const n=new Audio("/webapps/camera/assets/camera_shutter.mp3"),{$pager:o}=this.props;console.log("width",t.width(),"height",t.height());const a=$$.viewController(t,{data:{constraints:{width:{max:t.width()},height:{max:t.height()}}},events:{onTakePicture:function(t){n.play();const e=a.scope.camera.takePicture();o.pushPage("snapPage",{title:"Snapshot",props:{url:e},buttons:[{label:"Save",icon:"fa fa-save"}]})}}});a.scope.camera.start(),window.addEventListener("resize",function(){console.log("onresize"),a.setData({constraints:{width:{max:t.width()},height:{max:t.height()}}})})}}),$$.control.registerControl("snapPage",{deps:["breizbot.files"],template:'<div style="text-align: center;">\n\t<img bn-attr="{src: url}">\t\n</div>\n',props:{$pager:null,url:null},init:function(t,e){const{url:n,$pager:o}=this.props;$$.viewController(t,{data:{url:n}});this.onAction=function(t){console.log("onAction",t);const a="SNAP"+Date.now()+".png";console.log("fileName",a);const i=$$.util.dataURLtoBlob(n);e.uploadFile(i,a,"/images/camera").then(function(t){console.log("resp",t),o.popPage()}).catch(function(t){$$.ui.showAlert({title:"Error",content:t.responseText})})}}});