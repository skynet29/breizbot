$$.control.registerControl("rootPage",{template:'<video bn-attr="{src: url}" bn-bind="video" bn-event="playing: onPlaying, pause: onPaused"></video>',deps:["breizbot.pager"],props:{},init:function(e,n){let t=null;const o=$$.viewController(e,{data:{url:"#"},events:{onPlaying:function(){p({type:"event",name:"playing"})},onPaused:function(){p({type:"event",name:"paused"})}}}),a=o.scope.video.get(0),c=new AudioContext,i=c.createMediaElementSource(a),s=c.createGain();s.gain.value=1;const l=c.createBiquadFilter();l.type="lowpass",l.frequency.value=120;const r=c.createBiquadFilter();r.type="highpass",r.frequency.value=120;const u=c.createScriptProcessor(2048,2,1);u.onaudioprocess=function(e){const n=e.inputBuffer.getChannelData(0),t=e.inputBuffer.getChannelData(1),o=e.outputBuffer.getChannelData(0);for(let e=0;e<n.length;e++)o[e]=n[e]-t[e]};const d=c.createGain();function p(e){t.send(JSON.stringify(e))}function g(e){console.log("addConnection",e.state),t=e,p({type:"ready"}),e.addEventListener("message",function(e){const n=JSON.parse(e.data);switch(console.log("Message",n),n.type){case"url":o.setData({url:n.url});break;case"volume":a.volume=n.volume;break;case"play":a.play();break;case"pause":a.pause();break;case"enableKaraoke":t=n.enabled,d.gain.value=t?1:0,s.gain.value=t?0:1}var t}),e.addEventListener("connect",function(e){console.log("connected")}),e.addEventListener("close",function(e){console.log("Connection closed!")})}d.gain.value=0,i.connect(s),s.connect(c.destination),i.connect(l),l.connect(d),i.connect(r),r.connect(u),u.connect(d),d.connect(c.destination),navigator.presentation.receiver.connectionList.then(e=>{console.log(e.connections),e.connections.map(e=>g(e)),e.addEventListener("connectionavailable",function(e){console.log("connectionavailable"),g(e.connection)})})}});