$$.control.registerControl("rootPage",{template:'<video bn-attr="{src: url}" bn-bind="video" bn-event="playing: onPlaying, pause: onPaused, timeupdate: onTimeUpdate"></video>',deps:["breizbot.files"],props:{},init:function(e,n){let o=null;const t=$$.viewController(e,{data:{url:"#"},events:{onTimeUpdate:function(){d({type:"event",name:"timeUpdate",value:a.currentTime})},onPlaying:function(){d({type:"event",name:"playing"})},onPaused:function(){d({type:"event",name:"paused"})}}}),a=t.scope.video.get(0),c=new AudioContext,i=c.createMediaElementSource(a),s=c.createGain();s.gain.value=1;const l=c.createBiquadFilter();l.type="lowpass",l.frequency.value=120;const r=c.createBiquadFilter();r.type="highpass",r.frequency.value=120;const u=c.createGain();function d(e){o.send(JSON.stringify(e))}function p(e){console.log("addConnection",e.state),o=e,d({type:"ready"}),e.addEventListener("message",function(e){const n=JSON.parse(e.data);switch(console.log("Message",n),n.type){case"url":t.setData({url:n.url});break;case"volume":a.volume=n.volume;break;case"play":a.play();break;case"pause":a.pause();break;case"enableKaraoke":o=n.enabled,u.gain.value=o?1:0,s.gain.value=o?0:1}var o}),e.addEventListener("connect",function(e){console.log("connected")}),e.addEventListener("close",function(e){console.log("Connection closed!")})}u.gain.value=0,i.connect(s),s.connect(c.destination),i.connect(l),l.connect(u),i.connect(r),c.audioWorklet.addModule(n.assetsUrl("karaoke-processor.js")).then(()=>{console.log("audio module loaded");const e=new AudioWorkletNode(c,"karaoke-processor",{numberOfInputs:2,numberOfOutputs:1});r.connect(e),e.connect(u),u.connect(c.destination)}),navigator.presentation.receiver.connectionList.then(e=>{console.log(e.connections),e.connections.map(e=>p(e)),e.addEventListener("connectionavailable",function(e){console.log("connectionavailable"),p(e.connection)})})}});