$$.control.registerControl("rootPage",{template:'<div class="top">\n    <div>\n        <div class="loadLeft">\n            <button class="w3-button w3-blue" bn-event="click: onLoad" data-audio="audio1">LOAD 1\n                <i class="fa fa-spinner fa-pulse" bn-show="audio1"></i>\n            </button>\n        </div>\n        <div bn-control="audioplayer" bn-data="options" bn-iface="audio1"></div>\n    </div>\n    <div>\n        <div>\n            <button class="w3-button w3-blue" bn-event="click: onLoad" data-audio="audio2">LOAD 2\n                <i class="fa fa-spinner fa-pulse" bn-show="audio2"></i>\n            </button>\n        </div>\n        <div bn-control="audioplayer" bn-data="options" bn-iface="audio2"></div>\n    </div>\n</div>\n<div class="bottom">\n    <div class="balance">\n        <label>Left</label>\n        <div bn-control="brainjs.slider" bn-data="{min: 0, max: 1, step: 0.01}" bn-event="input: onSliderChange"></div>\n        <label>Right</label>\n    </div>\n    \n</div>\n<div bn-control="breizbot.filelist" bn-data="{selectionEnabled: true, filterExtension: \'mp3\', getMP3Info: true}" bn-iface="filelist"></div>\n',deps:["breizbot.pager"],props:{},init:function(n,t){const e=$$.viewController(n,{data:{audio1:!1,audio2:!1},events:{onSliderChange:function(){const n=$(this).getValue();c.gain.value=Math.cos(.5*(1-n)*Math.PI),u.gain.value=Math.cos(.5*n*Math.PI)},onLoad:async function(){const n=$(this).data("audio"),t=i.getSelFile();t&&(e.model[n]=!0,e.update(),await e.scope[n].setInfo(t),e.model[n]=!1,e.update())}}}),i=e.scope.filelist,a=e.scope.audio1.getAudioElement(),o=e.scope.audio2.getAudioElement(),l=new AudioContext,s=l.createMediaElementSource(a),d=l.createMediaElementSource(o),u=l.createGain(),c=l.createGain();u.gain.value=1,c.gain.value=0,s.connect(u),d.connect(c),u.connect(l.destination),c.connect(l.destination)}}),function(){function n(n){const t=new Date(1e3*n);return t.getMinutes().toString()+":"+t.getSeconds().toString().padStart(2,"0")}$$.control.registerControl("audioplayer",{template:'<div class="info">\n\t<div class="title" bn-show="!title">\n\t\t<strong>FileName:</strong>\n\t\t<span bn-text="name"></span>\n\t</div>\n\t<div class="title" bn-show="title">\n\t\t<strong>Title:</strong>\n\t\t<span bn-text="title"></span>\n\t</div>\n\t<div class="title" bn-show="artist">\n\t\t<strong>Artist:</strong>\n\t\t<span bn-text="artist"></span>\n\t</div>\n</div>\n<div class="toolbar">\n\t<div></div>\n\n\t<button bn-show="!playing" bn-event="click: onPlay" class="w3-btn w3-blue" title="Play" bn-icon="fa fa-lg fa-play">\n\t</button>\n\n\t<button bn-show="playing" bn-event="click: onPause" class="w3-btn w3-blue" title="Pause"\n\t\tbn-icon="fa fa-lg fa-pause">\n\t</button>\n\n\t<div class="toolbar2">\n\t\t<i class="fas fa-lg fa-volume-down w3-text-blue volume"></i>\n\t\t<div bn-control="brainjs.slider" bn-data="{min: 0, max:1, step: 0.1, orientation: \'vertical\'}"\n\t\t\tbn-event="input: onVolumeChange" bn-val="volume" class="volulmeSlider"></div>\n\t</div>\n\n</div>\n\n<div class="bufferContainer">\n\t<canvas bn-bind="bufferCanvas" class="bufferCanvas" width="370" height="50">\n</div>\n\n<div class="slider">\n\t<span bn-text="getTimeInfo"></span>\n\t<div bn-control="brainjs.slider" bn-data="{max: duration}" bn-event="input: onSliderChange" bn-val="curTime">\n\t</div>\n\n</div>\n\n<audio bn-attr="{src: url}" bn-bind="audio"\n\tbn-event="canplay: onLoad, timeupdate: onTimeUpdate, playing: onPlaying, pause: onPaused, ended: onEnded">\n</audio>',deps:["breizbot.pager"],props:{},init:function(t,e){const i=$$.viewController(t,{data:{url:"#",name:"",title:"",artist:"",volume:0,duration:0,curTime:0,playing:!1,getTimeInfo:function(){return`${n(this.curTime)} / ${n(this.duration)}`}},events:{onVolumeChange:function(n,t){a.volume=t},onLoad:function(){i.setData({duration:Math.floor(a.duration),volume:a.volume})},onTimeUpdate:function(){i.setData({curTime:this.currentTime}),o.update(this.currentTime)},onPlaying:function(){i.setData({playing:!0})},onPaused:function(){i.setData({playing:!1})},onPlay:function(){a.play()},onPause:function(){a.pause()},onSliderChange:function(n,t){a.currentTime=t}}}),a=i.scope.audio.get(0),o=function(n,t){const{width:e,height:i}=n;console.log({width:e,height:i});const a=n.getContext("2d");"function"==typeof t&&(n.onclick=function(n){console.log("onclick",n.offsetX);const i=n.offsetX/e*s.duration;t(i)});const o=document.createElement("canvas");o.width=e,o.height=i;const l=o.getContext("2d");let s=null;function d(n){if(s){a.clearRect(0,0,e,i),a.drawImage(o,0,5);const t=e*n/s.duration;a.fillStyle="rgba(255, 255, 255, 0.33)",a.fillRect(0,0,t,i)}}return{load:async function(n){s=await $$.media.getAudioBuffer(n),console.log("duration",s.duration),$$.media.drawAudioBuffer(e,i-10,l,s,"black"),d(0)},update:d}}(i.scope.bufferCanvas.get(0),n=>{console.log({time:n})});this.setInfo=async function(n){const{mp3:t,name:e,url:a}=n,{artist:l,title:s}=t;i.setData({name:e,url:a,artist:l,title:s}),await o.load(a)},this.getAudioElement=function(){return a}}})}();