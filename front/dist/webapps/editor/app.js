$$.control.registerControl("rootPage",{template:'<div class="titlebar"><strong bn-text="fileName"></strong></div>\n<div class="toolbar">\n\t<div bn-control="brainjs.controlgroup">\n\t\t<button title="New File" bn-event="click: onNewFile">\n\t\t\t<i class="fa fa-file"></i></button>\n\t\t<button title="Save File" bn-event="click: onSaveFile">\n\t\t\t<i class="fa fa-save"></i></button>\n\t\t<button title="Open File" bn-event="click: onOpenFile">\n\t\t\t<i class="fa fa-folder-open"></i></button>\n\t</div>\n\t<div bn-control="brainjs.controlgroup">\n\t\t<button title="Insert image" bn-event="click: onInsertImage">\n\t\t\t<i class="fa fa-image"></i></button>\n\t</div>\n</div>\n<div bn-control="brainjs.htmleditor" bn-iface="editor"></div>',deps:["breizbot.files","breizbot.pager"],init:function(e,t,o){const n=$$.viewController(e,{data:{fileName:"",rootDir:""},events:{onNewFile:function(e){console.log("onNewFile"),n.scope.editor.html(""),n.setData({fileName:""})},onSaveFile:async function(e){if(console.log("onSaveFile"),""!=n.model.fileName)return void i();let t=await $$.ui.showPrompt({title:"Save File",label:"FileName:"});console.log("fileName",t),null!=t&&(t+=".hdoc",n.setData({fileName:t,rootDir:"/apps/editor"}),i())},onOpenFile:function(e){console.log("onOpenFile"),o.pushPage("breizbot.files",{title:"Open File",props:{filterExtension:".hdoc"},events:{fileclick:function(e,t){o.popPage(t)}},onReturn:function(e){console.log("onReturn",e);const{fileName:o,rootDir:i}=e,l=t.fileUrl(i+o);n.setData({fileName:o,rootDir:i}),n.scope.editor.load(l)}})},onInsertImage:function(e){console.log("onInsertImage"),o.pushPage("breizbot.files",{title:"Insert Image",props:{imageOnly:!0,showThumbnail:!0},events:{fileclick:function(e,t){o.popPage(t)}},onReturn:function(e){console.log("onReturn",e);const{fileName:o,rootDir:i}=e,l=t.fileUrl(i+o);n.scope.editor.insertImage(l)}})}}});async function i(){const{fileName:e,rootDir:o}=n.model,i=n.scope.editor.html(),l=new Blob([i],{type:"text/html"});try{const n=await t.uploadFile(l,e,o);console.log("resp",n)}catch(e){$$.ui.showAlert({title:"Error",content:e.responseText})}}}});