$$.control.registerControl("addFriendPage",{deps:["breizbot.users","breizbot.params"],template:'<div bn-control="breizbot.searchbar" \n\tbn-bind="searchbar"\n\tbn-event="searchbarsubmit: onSearch"\n\tdata-placeholder="Search username"></div>\n\n<div class="scrollPanel">\n\t<p bn-show="show1">No results</p>\n\t<ul class="w3-ul w3-border w3-white" \n\t\tbn-event="click.invit: onInvit"\n\t\tbn-each="friends"\n\t\tbn-show="!show1"\n\t\t>\n\t\t<li class="w3-bar">\n\t\t\t<span class="w3-button w3-right invit" title="Invit" bn-data="{username: $scope.$i.username}"><i class="fa fa-plus"></i></span>\n\n\t\t\t<div class="w3-bar-item">\n\t\t\t\t<i class="fa fa-user w3-text-blue"></i>\n\t\t\t\t<span bn-text="$scope.$i.username"></span><br>\n\t\t\t\t<i class="fa fa-map-marker-alt w3-text-blue"></i>\n\t\t\t\t<span bn-text="$scope.$i.location"></span>\n\t\t\t</div>\n\t\t</li>\n\t</ul>\t\t\n</div>\n',props:{friends:[]},init:function(t,n,e){const s=this.props.friends,i=$$.viewController(t,{data:{friends:[],show1:function(){return 0==this.friends.length}},events:{onSearch:async function(t,s){console.log("onSearch",s);const o=await n.match(s.value);i.setData({friends:o.filter(t=>t.username!=e.$userName)})},onInvit:async function(t){const e=$(this).data("username");console.log("onInvit",e),s.includes(e)?$$.ui.showAlert({title:"Warning",content:`\n\t\t\t\t\t\t\tUser <strong>${e}</strong> is already your friend\n\t\t\t\t\t\t\t`}):(await n.sendNotif(e,{type:"invit"}),$$.ui.showAlert({title:"Add Friend",content:`An invitation was sent to user <strong>${e}</strong>`}))}}})}}),$$.control.registerControl("groups",{template:'<div>\n    <div class="position">\n        <span>Share position with this friend</span>\n        <div bn-control="brainjs.flipswitch" bn-val="positionAuth" bn-update="flipswitchchange"></div>\n    </div>\n    <strong>Groups</strong>\n\n    <div bn-show="noGroups">No group available</div>\n    <div bn-each="groups" class="items" bn-control="brainjs.checkgroup" bn-val="selectedGroups" bn-update="input">\n        <div class="item">\n            <input type="checkbox" bn-attr="{value: $scope.$i}" class="w3-check">\n\n            <span bn-text="$scope.$i"></span>\n        </div>\n    </div>\n</div>',deps:["breizbot.users","breizbot.pager"],props:{friendUserName:""},init:function(t,n,e){const{friendUserName:s}=this.props,i=$$.viewController(t,{data:{groups:[],positionAuth:!1,selectedGroups:[],noGroups:function(){return 0==this.groups.length}}});async function o(){const t=await n.getSharingGroups(),e=await n.getFriendInfo(s),o=e.groups,{positionAuth:a}=e;i.setData({groups:t,selectedGroups:[],positionAuth:a}),i.setData({selectedGroups:o})}o(),this.getButtons=function(){return{addGroup:{title:"Add Group",icon:"fa fa-user-plus",onClick:async function(){const t=await $$.ui.showPrompt({title:"Add Group",label:"Name"});null!=t&&(await n.addSharingGroup(t),o())}},apply:{title:"Apply",icon:"fa fa-check",onClick:async function(){const{selectedGroups:t,positionAuth:o}=i.model;await n.setFriendInfo(s,t,o),e.popPage()}}}}}}),$$.control.registerControl("rootPage",{template:'<div class="toolbar">\n\t<button \n\t\tclass="w3-button" \n\t\ttitle="Update"\n\t\tbn-event="click: onUpdate"\n\n\t><i class="fa fa-redo"></i></button>\t\n\n\t<button \n\t\tclass="w3-button" \n\t\ttitle="Add Friend"\n\t\tbn-event="click: onAddFriend"\n\n\t><i class="fa fa-search"></i></button>\t\n</div>\n<div bn-control="breizbot.friends" \n\tbn-iface="friends" \n\tbn-event="friendclick: onItemClick"\n\tdata-show-send-message="true"></div>',deps:["breizbot.pager"],init:function(t,n){const e=$$.viewController(t,{data:{},events:{onAddFriend:function(t){console.log("onAddFriend"),n.pushPage("addFriendPage",{title:"Search Friend",props:{friends:e.scope.friends.getFriends()}})},onUpdate:function(){e.scope.friends.update()},onItemClick:function(t,e){const s=e.userName;n.pushPage("groups",{title:s,props:{friendUserName:s}})}}})}});