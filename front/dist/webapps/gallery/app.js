$$.control.registerControl("files",{template:'<div \n\tbn-control="breizbot.files" \n\tbn-data="{imageOnly: true, friendUser}"\n\tbn-event="fileclick: onFileClick"\n\tbn-iface="files"\n\t></div>',deps:["breizbot.pager"],props:{friendUser:""},init:function(t,e){const{friendUser:n}=this.props,i=$$.viewController(t,{data:{friendUser:n},events:{onFileClick:function(t,s){const{rootDir:o,fileName:l}=s,a=i.scope.files.getFiles(),r=a.findIndex(t=>t.name==l);e.pushPage("gallery",{title:"Diaporama",props:{firstIdx:r,files:a,rootDir:o,friendUser:n}})}}})}}),$$.control.registerControl("friends",{template:'<p>Select a friends</p>\n<div \n\tbn-control="breizbot.friends" \n\tbn-event="friendclick: onSelectFriend"\n\tbn-data="{showConnectionState: false}"\n\t></div>',deps:["breizbot.pager"],init:function(t,e){$$.viewController(t,{data:{},events:{onSelectFriend:function(t,n){console.log("onSelectFriend",n);const{userName:i}=n;e.pushPage("files",{title:i,props:{friendUser:i}})}}})}}),$$.control.registerControl("gallery",{template:'<div class="content">\n\t<div bn-control="brainjs.image" bn-data="{src}" bn-iface="image"></div>\n\t<div class="buttons" bn-show="showButtons">\n\t\t<div>\n\t\t\t<button \n\t\t\t\tclass="w3-button w3-circle w3-blue-grey" \n\t\t\t\tbn-show="idx > 0"\n\t\t\t\tbn-event="click: onPrevImage"\n\t\t\t\t><i class="fa fa-angle-left"></i>\n\t\t\t</button>\t\t\n\t\t</div>\n\t\t<div>\n\t\t\t<button \n\t\t\t\tclass="w3-button w3-circle w3-blue-grey"  \n\t\t\t\tbn-show="idx < nbImages - 1"\n\t\t\t\tbn-event="click: onNextImage"\n\t\t\t\t>\n\t\t\t\t<i class="fa fa-angle-right"></i>\n\t\t\t</button>\t\n\t\t</div>\n\n\t</div>\t\n</div>\n<div class="band w3-blue-grey" bn-bind="band" bn-show="showButtons">\n\t<div bn-each="thumbnails" bn-event="click.image: onImageClick" bn-style="{width}">\n\t\t<img bn-attr="{src: $i}" class="image">\t\t\t\n\t</div>\n</div>\n',deps:["breizbot.files","breizbot.pager"],props:{rootDir:"",files:[],firstIdx:0,friendUser:""},buttons:[{name:"play",icon:"fa fa-play",title:"Play"},{name:"pause",icon:"fa fa-pause",title:"Pause",visible:!1}],init:function(t,e,n){const{rootDir:i,files:s,firstIdx:o,friendUser:l}=this.props,a=1e4;let r;const d=$$.viewController(t,{data:{idx:o,nbImages:s.length,src:f(o),thumbnails:s.map(t=>e.fileThumbnailUrl(i+t.name,"?x50",l)),width:s.reduce((t,e)=>{const{width:n,height:i}=e.dimension;return t+50*n/i+5},0)+"px",showButtons:!0},events:{onPrevImage:function(){d.model.idx--,c()},onNextImage:function(){d.model.idx++,c()},onImageClick:function(){const t=$(this).index();d.model.idx=t,c()}}});function c(){d.setData({src:f(d.model.idx)}),d.scope.band.find("img.selected").removeClass("selected");const t=d.scope.band.find("img").eq(d.model.idx);t.addClass("selected"),t.get(0).scrollIntoView()}function f(t){return e.fileUrl(i+s[t].name,l)}function b(){clearInterval(r),n.setButtonVisible({play:!0,pause:!1}),d.setData({showButtons:!0}),d.scope.image.enableHandlers(!0),d.scope.image.invalidateSize(),r=void 0}c(),this.onAction=function(t){"play"==t&&(n.setButtonVisible({play:!1,pause:!0}),d.setData({showButtons:!1}),d.scope.image.enableHandlers(!1),d.scope.image.invalidateSize(),d.model.idx==d.model.nbImages-1&&(d.model.idx=0,c()),r=setInterval(()=>{d.model.idx==d.model.nbImages-1?b():(d.model.idx++,c())},a)),"pause"==t&&b()},this.dispose=function(){null!=r&&clearInterval(r)}}}),$$.control.registerControl("rootPage",{template:'<p>Select a file system</p>\n<ul class="w3-ul w3-border w3-white">\n\t<li class="w3-bar" bn-event="click: onHome">\n\t\t<div class="w3-bar-item">\n\t\t\t<i class="fa fa-home fa-2x fa-fw w3-text-blue"></i>\n\t\t\t<span>Your home files</span>\n\t\t</div>\n\t</li>\n\n\t<li class="w3-bar" bn-event="click: onShare">\n\t\t<div class="w3-bar-item">\n\t\t\t<i class="fa fa-share-alt fa-2x fa-fw w3-text-blue"></i>\n\t\t\t<span>Files shared by your friends</span>\n\t\t</div>\n\t</li>\n</ul>\t',deps:["breizbot.pager"],init:function(t,e){$$.viewController(t,{data:{},events:{onHome:function(){console.log("onHome"),e.pushPage("files",{title:"Home files"})},onShare:function(){console.log("onShare"),e.pushPage("friends",{title:"Shared files"})}}})}});