$$.control.registerControl("gallery",{template:'<div class="content">\n\t<div bn-control="brainjs.image" bn-data="{src}" bn-iface="image"></div>\n\t<div class="buttons" bn-show="showButtons">\n\t\t<div>\n\t\t\t<button \n\t\t\t\tclass="w3-button w3-circle w3-blue-grey" \n\t\t\t\tbn-show="idx > 0"\n\t\t\t\tbn-event="click: onPrevImage"\n\t\t\t\t><i class="fa fa-angle-left"></i>\n\t\t\t</button>\t\t\n\t\t</div>\n\t\t<div>\n\t\t\t<button \n\t\t\t\tclass="w3-button w3-circle w3-blue-grey"  \n\t\t\t\tbn-show="idx < nbImages - 1"\n\t\t\t\tbn-event="click: onNextImage"\n\t\t\t\t>\n\t\t\t\t<i class="fa fa-angle-right"></i>\n\t\t\t</button>\t\n\t\t</div>\n\n\t</div>\t\n</div>\n<div class="band w3-blue-grey" bn-bind="band" bn-show="showButtons">\n\t<div bn-each="thumbnails" bn-event="click.image: onImageClick" bn-style="{width}">\n\t\t<img bn-attr="{src: $i}" class="image">\t\t\t\n\t</div>\n</div>\n',deps:["breizbot.files"],props:{rootDir:"",files:[],firstIdx:0,$pager:null},buttons:[{name:"play",icon:"fa fa-play",title:"Play"},{name:"pause",icon:"fa fa-pause",title:"Pause",visible:!1}],init:function(t,e){const{rootDir:n,files:i,firstIdx:o,$pager:s}=this.props,a=2e4;let l;const d=$$.viewController(t,{data:{idx:o,nbImages:i.length,src:c(o),thumbnails:i.map(t=>e.fileThumbnailUrl(n+t.name,"?x50")),width:i.reduce((t,e)=>{const{width:n,height:i}=e.dimension;return t+50*n/i+5},0)+"px",showButtons:!0},events:{onPrevImage:function(){d.model.idx--,r()},onNextImage:function(){d.model.idx++,r()},onImageClick:function(){const t=$(this).index();d.model.idx=t,r()}}});function r(){d.setData({src:c(d.model.idx)}),d.scope.band.find("img.selected").removeClass("selected");const t=d.scope.band.find("img").eq(d.model.idx);t.addClass("selected"),t.get(0).scrollIntoView()}function c(t){return e.fileUrl(n+i[t].name)}function b(){clearInterval(l),s.setButtonVisible({play:!0,pause:!1}),d.setData({showButtons:!0}),d.scope.image.enableHandlers(!0),d.scope.image.invalidateSize(),l=void 0}r(),this.onAction=function(t){"play"==t&&(s.setButtonVisible({play:!1,pause:!0}),d.setData({showButtons:!1}),d.scope.image.enableHandlers(!1),d.scope.image.invalidateSize(),d.model.idx==d.model.nbImages-1&&(d.model.idx=0,r()),l=setInterval(()=>{d.model.idx==d.model.nbImages-1?b():(d.model.idx++,r())},a)),"pause"==t&&b()},this.dispose=function(){null!=l&&clearInterval(l)}}}),$$.control.registerControl("rootPage",{template:'<div \n\tbn-control="breizbot.files" \n\tbn-data="{imageOnly: true, showThumbnail: true}"\n\tbn-event="fileclick: onFileClick"\n\tbn-iface="files"\n\t></div>',props:{$pager:null},init:function(t){const{$pager:e}=this.props,n=$$.viewController(t,{data:{},events:{onFileClick:function(t,i){const{rootDir:o,fileName:s}=i,a=n.scope.files.getFiles(),l=a.findIndex(t=>t.name==s);e.pushPage("gallery",{title:"Diaporama",props:{firstIdx:l,files:a,rootDir:o}})}}})}});