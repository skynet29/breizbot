$$.control.registerControl("gallery",{template:'<div class="content">\n\t<div bn-control="brainjs.image" bn-data="{src}" bn-iface="image"></div>\n\t<div class="buttons" bn-show="showButtons">\n\t\t<div>\n\t\t\t<button \n\t\t\t\tclass="w3-button w3-circle w3-blue-grey" \n\t\t\t\tbn-show="show1"\n\t\t\t\tbn-event="click: onPrevImage"\n\t\t\t\t><i class="fa fa-angle-left"></i>\n\t\t\t</button>\t\t\n\t\t</div>\n\t\t<div>\n\t\t\t<button \n\t\t\t\tclass="w3-button w3-circle w3-blue-grey"  \n\t\t\t\tbn-show="show2"\n\t\t\t\tbn-event="click: onNextImage"\n\t\t\t\t>\n\t\t\t\t<i class="fa fa-angle-right"></i>\n\t\t\t</button>\t\n\t\t</div>\n\n\t</div>\t\n</div>\n<div class="band w3-blue-grey" bn-bind="band" bn-show="showButtons">\n\t<div bn-each="thumbnails" bn-event="click.image: onImageClick" bn-style="{width}">\n\t\t<img bn-attr="{src: $scope.$i}" class="image">\t\t\t\n\t</div>\n</div>\n',deps:["breizbot.files","breizbot.pager"],props:{rootDir:"",files:[],firstIdx:0,friendUser:""},init:function(t,e,n){const{rootDir:i,files:s,firstIdx:o,friendUser:a}=this.props,l=1e4;let r;const c=$$.viewController(t,{data:{idx:o,nbImages:s.length,src:f(o),thumbnails:s.map(t=>e.fileThumbnailUrl(i+t.name,"?x50",a)),width:s.reduce((t,e)=>{const{width:n,height:i}=e.dimension;return t+50*n/i+5},0)+"px",showButtons:!0,show1:function(){return this.idx>0},show2:function(){return this.idx<this.nbImages-1}},events:{onPrevImage:function(){c.model.idx--,d()},onNextImage:function(){c.model.idx++,d()},onImageClick:function(){const t=$(this).index();c.model.idx=t,d()}}});function d(){c.setData({src:f(c.model.idx)}),c.scope.band.find("img.selected").removeClass("selected");const t=c.scope.band.find("img").eq(c.model.idx);t.addClass("selected"),t.get(0).scrollIntoView()}function f(t){return e.fileUrl(i+s[t].name,a)}function b(){clearInterval(r),n.setButtonVisible({play:!0,pause:!1}),c.setData({showButtons:!0}),c.scope.image.enableHandlers(!0),c.scope.image.invalidateSize(),r=void 0}function u(){n.setButtonVisible({play:!1,pause:!0}),c.setData({showButtons:!1}),c.scope.image.enableHandlers(!1),c.scope.image.invalidateSize(),c.model.idx==c.model.nbImages-1&&(c.model.idx=0,d()),r=setInterval(()=>{c.model.idx==c.model.nbImages-1?b():(c.model.idx++,d())},l)}d(),this.getButtons=function(){return{play:{icon:"fa fa-play",title:"Play",onClick:u},pause:{icon:"fa fa-pause",title:"Pause",visible:!1,onClick:b}}},this.dispose=function(){null!=r&&clearInterval(r)}}}),$$.control.registerControl("rootPage",{template:'<p>Select a file system</p>\n<ul class="w3-ul w3-border w3-white">\n\t<li class="w3-bar" bn-event="click: onHome">\n\t\t<div class="w3-bar-item">\n\t\t\t<i class="fa fa-home fa-2x fa-fw w3-text-blue"></i>\n\t\t\t<span>Your home files</span>\n\t\t</div>\n\t</li>\n\n\t<li class="w3-bar" bn-event="click: onShare">\n\t\t<div class="w3-bar-item">\n\t\t\t<i class="fa fa-share-alt fa-2x fa-fw w3-text-blue"></i>\n\t\t\t<span>Files shared by your friends</span>\n\t\t</div>\n\t</li>\n</ul>\t',deps:["breizbot.pager"],init:function(t,e){function n(t,n){e.pushPage("breizbot.files",{title:t,props:{filterExtension:"jpg,png,jpeg",friendUser:n},events:{fileclick:function(t,i){const{rootDir:s,fileName:o}=i,a=$(this).iface().getFiles(),l=a.findIndex(t=>t.name==o);e.pushPage("gallery",{title:"Diaporama",props:{firstIdx:l,files:a,rootDir:s,friendUser:n}})}}})}$$.viewController(t,{data:{},events:{onHome:function(){n("Home files","")},onShare:function(){e.pushPage("breizbot.friends",{title:"Shared files",props:{showConnectionState:!1},events:{friendclick:function(t,e){const{userName:i}=e;n(i,i)}}})}}})}});