$$.control.registerControl("rootPage",{deps:["breizbot.users","breizbot.broker"],template:'<div class="scrollPanel">\n\t<ul class="w3-ul w3-border w3-white" \n\t\tbn-each="notifs" bn-iter="n"\n\t\tbn-event="click.delete: onDelete, click.accept: onAccept, click.decline: onDecline, click.reply: onReply"\n\t\t>\n\t\t<li class="w3-bar" bn-data="{item: n}" bn-show="show1">\n\t\t\t<span class="w3-button w3-right w3-blue delete" title="Delete"><i class="fa fa-times"></i></span>\n\t\t\t<span class="w3-button w3-right w3-blue reply" title="Reply" bn-show="show2"><i class="fa fa-reply"></i></span>\n\n\t\t\t<div class="w3-bar-item">\n\t\t\t\tFrom: <span bn-text="n.from"></span><br>\n\t\t\t\tDate: <span bn-text="text1"></span>\n\t\t\t\tat <span bn-text="text2"></span>\n\t\t\t\t<br>\n\t\t\t\tMessage: <span bn-html="n.notif.text"></span>\n\t\t\t</div>\n\t\t</li>\n\n\t\t<li class="w3-bar" bn-data="{item: n}" bn-show="isInvit">\n\t\t\t<span class="w3-button w3-right w3-green accept"><i class="fa fa-user-check"></i></span>\n\t\t\t<span class="w3-button w3-right w3-red decline"><i class="fa fa-user-slash"></i></span>\n\n\t\t\t<div class="w3-bar-item">\n\t\t\t\tFrom: <span bn-text="n.from"></span><br>\n\t\t\t\tDate: <span bn-text="text1"></span>\n\t\t\t\tat <span bn-text="text2"></span>\n\t\t\t\t<br>\n\t\t\t\tMessage: <strong>I want to be your friend</strong>\n\t\t\t</div>\n\t\t</li>\t\t\t\n\t</ul>\t\n</div>',init:function(t,n,e){const s=$$.viewController(t,{data:{notifs:[],show1:function(){return"string"==typeof this.n.notif.text},show2:function(){return!0===this.n.notif.reply},text1:function(){return new Date(this.n.date).toLocaleDateString()},text2:function(){return new Date(this.n.date).toLocaleTimeString()},isInvit:function(){return"invit"===this.n.notif.type}},events:{onDelete:function(){const t=$(this).closest("li").data("item");console.log("onDelete",t),n.removeNotif(t._id)},onAccept:function(){const t=$(this).closest("li").data("item");console.log("onAccept",t);const e=t.from;n.addFriend(e).then(()=>n.removeNotif(t._id).then(()=>n.sendNotif(e,{text:"User has accepted your invitation"})))},onDecline:function(){const t=$(this).closest("li").data("item");console.log("onDecline",t);const e=t.from;n.removeNotif(t._id).then(()=>n.sendNotif(e,{text:"User has declined your invitation"}))},onReply:function(t){const e=$(this).closest("li").data("item");console.log("onReply",e);const s=e.from;$$.ui.showPrompt({title:"Reply",label:"Message:"},function(t){n.removeNotif(e._id).then(()=>n.sendNotif(s,{text:t,reply:!0}))})}}});function o(){n.getNotifs().then(t=>{console.log("notifs",t),s.setData({notifs:t})})}e.register("breizbot.notifCount",function(t){o()}),o()}});