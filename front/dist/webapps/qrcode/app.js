$$.control.registerControl("rootPage",{template:'<div\n\tbn-control="brainjs.slider",\n\tdata-orientation=\'vertical\',\n\tclass="slider"\n\tbn-show="hasZoom"\n\tbn-event="slidechange: onZoomChange"\n\tbn-iface="slider"\n></div>\n\n<div class="main w3-pale-blue">\n\t<div bn-show="showMessage">Sorry, no video device found !</div>\n\t<div \n\t\tbn-control="brainjs.camera" \n\t\tbn-event="cameraready: onCameraReady"\n\t\tbn-data="{\n\t\t\tconstraints: {\n\t\t\t\tvideo: {\n\t\t\t\t\tfacingMode: \'environment\'\n\t\t\t\t}\n\t\t\t}\n\t\t}"\n\t\tbn-iface="camera">\n\t\t\t\n\t\t</div>\t\n\t\n</div>\n',init:function(t){const e=new BarcodeDetector;let n=null;function o(){n.grabFrame().then(t=>e.detect(t)).then(t=>{if(0==t.length)setTimeout(o,1e3);else{console.log("barcodes",t);const{format:e,rawValue:n}=t[0];let a=null;a="qr_code"==e?{link:`<a href="${n}" target="_blank">${n}</a>`}:{format:e,value:n},$$.ui.showAlert({title:"BarCode Detected",content:a},()=>{o()})}}).catch(t=>{console.error("BarcodeDetection failed: ",t),$$.ui.showAlert({title:"Error",content:t.message})})}const a=$$.viewController(t,{data:{showMessage:!1,hasZoom:!1},events:{onCameraReady:function(t){console.log("onCameraReady");const e=$(this).iface();n=e.getImageCapture(),setTimeout(()=>{const t=e.getCapabilities();if(t.zoom){const n=e.getSettings(),{min:o,max:s,step:i}=t.zoom;a.scope.slider.setData({min:o,max:s,step:i}),a.scope.slider.setValue(n.zoom),a.setData({hasZoom:!0})}o()},500)},onZoomChange:function(t){const e=$(this).getValue();console.log("onZoomChange",e),a.scope.camera.setZoom(e)}}});$$.util.getVideoDevices().then(t=>{t.length>0?a.scope.camera.start():a.setData({showMessage:!0})})}});