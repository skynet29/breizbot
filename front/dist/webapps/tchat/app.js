$$.control.registerControl("rootPage",{template:'<div bn-control="breizbot.rtc" \n\tbn-data="{\n\t\tappName:\'tchat\',\n\t\ticonCls: \'fa fa-comments\',\n\t\ttitle: \'Select a friend to tchat with\'\n\t}"\n\tbn-event="rtchangup: onHangup"\n>\n\n\n\t<div class="content" bn-bind="content">\n\t\t<div bn-each="messages" class="messages">\n\t\t\t<div class="me" bn-show="$scope.$i.me">\n\t\t\t\t<div bn-text="$scope.$i.text" class="text"></div>\n\t\t\t\t<div bn-text="$scope.$i.time"></div>\t\t\t\n\t\t\t</div>\n\t\t\t<div class="you" bn-show="!$scope.$i.me">\n\t\t\t\t<div bn-text="$scope.$i.time"></div>\t\t\t\n\t\t\t\t<div bn-text="$scope.$i.text" class="text"></div>\n\t\t\t</div>\n\t\t</div>\n\t\t\n\t</div>\n\n\t<div class="footer">\n\t\t<form bn-event="submit: onSubmit">\n\t\t\t<input type="text" name="message" required="" placeholder="Write a message..." autocomplete="off">\n\t\t\t<button class="w3-button w3-blue" type="submit">Send</button>\n\t\t</form>\n\t</div>\n\n</div>',deps:["breizbot.rtc"],init:function(t,e){e.on("bye",()=>{n.setData({messages:[]})});const n=$$.viewController(t,{data:{messages:[]},events:{onSubmit:function(t){t.preventDefault();const{message:n}=$(this).getFormData();$(this).resetForm(),console.log("onSubmit",n),e.sendData("tchat",n),s(n,!0,new Date)},onHangup:function(){n.setData({messages:[]})}}});function s(t,e,s){n.model.messages.push({text:t,me:e,time:s.toLocaleTimeString()}),n.update(),n.scope.content.scrollToBottom()}e.onData("tchat",function(t,e){s(t,!1,new Date(e))}),e.on("ready",()=>{e.isCallee()&&e.accept()}),this.onAppExit=function(){return e.exit()}}});