$$.control.registerControl("rootPage",{template:'\n\n<form bn-event="submit: onStart" bn-bind="form">\n\t<input type="url" name="url" placeholder="Paste video link url here" required="">\n\t<button class="w3-button w3-blue" type="submit"><i class="fa fa-search"></i></button>\n</form>\n\n<div class="w3-border" bn-show="percent != \'0%\'">\n\t<div class="w3-container w3-green w3-center" bn-style="{width: percent}" bn-text="percent"></div>\n</div>\n\n<div class="info" bn-show="title != \'\'">\n\t<div class="thumbnail">\n\t\t<img bn-attr="{src: thumbnail_url}">\n\t\t<div class="download" bn-show="percent == \'0%\'">\n\t\t\t<button \n\t\t\t\tclass="w3-button w3-green" \n\t\t\t\ttitle="Download"\n\t\t\t\tbn-event="click: onDownload"\n\t\t\t\t><i class="fa fa-download"></i></button>\n\t\t\t\n\t\t</div>\n\t</div>\n\t<div class="details">\n\t\t<div>\n\t\t\t<strong>Title: </strong> <span bn-text="title"></span>\t\t\t\t\n\t\t</div>\n\t\t<div>\n\t\t\t<strong>Length: </strong><span bn-text="new Date(length_seconds*1000).toLocaleTimeString(\'fr-FR\', {timeZone: \'UTC\'})"></span>\t\n\t\t</div>\n\t\t<div class="description">\n\t\t\t<strong>Description: </strong><textarea bn-text="description"></textarea>\t\n\t\t</div>\t\t\n\t\t\n\t</div>\t\n\n\n\n</div>\n\t\n',deps:["app.ytdl","breizbot.broker"],init:function(t,n,e){let o;const i=$$.viewController(t,{data:{title:"",length_seconds:0,thumbnail_url:"#",description:"",percent:"0%"},events:{onStart:function(t){t.preventDefault();const{url:e}=$(this).getFormData();console.log("onStart",e),n.info(e).then(t=>{console.log("info",t),t.percent="0%",i.setData(t)})},onDownload:function(t){const{url:e}=i.scope.form.getFormData();console.log("onDownload",e,o);const r=i.model.title+".mp4";n.download(e,r,o)}}});e.onTopic("breizbot.ytdl.progress",t=>{1!=t.hist&&i.setData({percent:t.data.percent+"%"})}),e.on("ready",t=>{o=t.clientId})}}),$$.service.registerService("app.ytdl",{deps:["breizbot.http"],init:function(t,n){return{info:function(t){return n.get("info",{url:t})},download:function(t,e,o){return n.post("download",{url:t,fileName:e,srcId:o})}}}});